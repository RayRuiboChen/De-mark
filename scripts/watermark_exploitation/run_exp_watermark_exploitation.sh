gpu_num=4

# "meta-llama/Meta-Llama-3.1-8B-Instruct" "meta-llama/Llama-3.2-3B-Instruct" "mistralai/Mistral-7B-Instruct-v0.3" 
target_model_id='meta-llama/Llama-3.2-3B-Instruct' 
surrogate_model_id='meta-llama/Llama-3.2-1B-Instruct'
delta_actual=2
delta_predicted=2
delta_reduce_multiplier=1 #eta


max_new_token=300
total_word_num=20
#mmw_mmw_story mmw_book_report dolly_cw  mmw_fake_news
prompt_set_name="dolly_cw"

save_dir="../results/watermark_exploitation/"

cd ./demark

save_name_suffix=$(date +%Y%m%d%H%M%S)
task_num=$gpu_num
task_idx=0
while [ $task_idx -lt $task_num ]
do
    CUDA_VISIBLE_DEVICES=$task_idx python exp_exploit_watermark.py \
        --task_idx $task_idx \
        --total_task_num $task_num \
        --target_model_id $target_model_id \
        --surrogate_model_id $surrogate_model_id \
        --prompt_set_name $prompt_set_name \
        --delta_actual $delta_actual \
        --delta_predicted $delta_predicted \
        --max_new_token $max_new_token \
        --total_word_num $total_word_num \
        --save_name_suffix $save_name_suffix \
        --save_dir $save_dir &
        

    task_idx=$((task_idx + 1))
done
